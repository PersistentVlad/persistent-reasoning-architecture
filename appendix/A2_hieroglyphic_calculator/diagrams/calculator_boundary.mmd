%% File: persistent-reasoning-architecture/appendix/A2_hieroglyphic_calculator/diagrams/calculator_boundary.mmd
%% Purpose: Show A2 as an architectural boundary case (not a solver, not a UI, not a KG).

flowchart LR
  U["User task / query"] --> O["Reasoning Orchestrator / Inference"]

  O -->|proposes| P["Proposal<br/>(candidate step / revision)"]
  P --> G["PR Governance / Commit Gate"]
  G -->|commit| L[(Append-only Lineage)]
  L --> S["A2: Hieroglyphic Calculator Store<br/>(invariants + admissible transforms)"]

  O -->|navigate / read| S
  S -->|returns allowed transforms<br/>+ violation signals| O

  O -->|optional call| X["External solver / tool<br/>(CAS / theorem prover / numeric)"]
  X -->|results| O

  O -.->|direct write forbidden| S
  X -.->|mutate invariants forbidden| S
  S -.->|solve or answer forbidden| U